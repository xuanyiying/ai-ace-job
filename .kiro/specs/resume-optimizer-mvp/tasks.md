# 实施任务列表

## 项目初始化

- [x] 1. 项目脚手架搭建
  - 创建 monorepo 结构（frontend + backend）
  - 配置 TypeScript、ESLint、Prettier
  - 设置 Git 仓库和 .gitignore
  - 配置环境变量管理（.env 文件）
  - _需求: 所有_

- [x] 2. 后端基础设施搭建
  - 初始化 NestJS 项目
  - 配置 Prisma ORM 和 PostgreSQL 连接
  - 配置 Redis 连接
  - 设置 Swagger/OpenAPI 文档
  - 配置日志系统（Winston）
  - _需求: 10.1, 12.5_

- [x] 3. 前端基础设施搭建
  - 初始化 React + Vite 项目
  - 配置 Ant Design UI 库
  - 配置 Zustand 状态管理
  - 配置 Axios HTTP 客户端
  - 设置路由（React Router）
  - _需求: 所有_

## 数据库设计与实现

- [x] 4. 数据库模式设计
  - 编写 Prisma schema 定义所有表结构
  - 创建用户表（users）
  - 创建对话会话表（conversations）
  - 创建消息表（messages）
  - 创建简历表（resumes）
  - 创建职位表（jobs）
  - 创建优化记录表（optimizations）
  - 创建 PDF 生成记录表（generated_pdfs）
  - 创建面试问题表（interview_questions）
  - 创建模板表（templates）
  - _需求: 1, 2, 3, 4, 5, 6, 7, 8, 9_

- [x] 5. 数据库迁移和种子数据
  - 运行 Prisma 迁移创建数据库表
  - 创建索引以优化查询性能
  - 编写种子脚本插入初始模板数据
  - _需求: 7.2_

- [ ]\* 5.1 编写数据库模式单元测试
  - 测试 Prisma 模型定义
  - 测试数据库约束（唯一性、外键等）
  - _需求: 1, 2, 3_

## 对话会话管理

- [x] 5.5 实现对话服务
  - 创建 ConversationService 类
  - 实现创建对话会话（createConversation）
  - 实现获取对话会话（getConversation）
  - 实现对话列表查询（listConversations）
  - 实现对话更新（updateConversation）
  - 实现对话删除（deleteConversation）
  - 实现添加消息（addMessage）
  - 实现获取消息列表（getMessages）
  - _需求: 1_

- [ ]\* 5.5.1 编写对话服务单元测试
  - 测试对话 CRUD 操作
  - 测试消息管理
  - _需求: 1_

## 用户认证与授权

- [x] 6. 实现用户服务
  - 创建 UserService 类
  - 实现用户注册功能（register）
  - 实现用户登录功能（login）
  - 实现密码哈希（bcrypt）
  - 实现 JWT 令牌生成和验证
  - _需求: 1.1, 1.2, 1.5_

- [ ]\* 6.1 编写属性测试：用户注册唯一性
  - **属性 1: 用户注册唯一性**
  - **验证: 需求 1.1**

- [ ]\* 6.2 编写属性测试：密码加密存储
  - **属性 2: 密码加密存储**
  - **验证: 需求 1.5**

- [x] 7. 实现认证中间件
  - 创建 JWT 认证守卫（AuthGuard）
  - 实现令牌验证逻辑
  - 实现令牌过期检查
  - _需求: 1.3_

- [ ]\* 7.1 编写属性测试：认证令牌过期
  - **属性 3: 认证令牌过期**
  - **验证: 需求 1.3**

- [x] 8. 实现用户账户管理
  - 实现账户删除功能（deleteAccount）
  - 实现订阅管理功能（updateSubscription）
  - 实现数据导出功能（GDPR 合规）
  - _需求: 1.4, 9.6_

- [ ]\* 8.1 编写用户服务单元测试
  - 测试注册、登录、删除等功能
  - 测试错误处理
  - _需求: 1_

## 简历上传与解析

- [x] 9. 实现文件上传功能
  - 创建 ResumeService 类
  - 实现文件上传接口（uploadResume）
  - 配置文件大小和格式验证
  - 集成对象存储（AWS S3 或阿里云 OSS）
  - _需求: 2.1, 2.2_

- [ ]\* 9.1 编写属性测试：文件上传格式验证
  - **属性 4: 文件上传格式验证**
  - **验证: 需求 2.1, 2.2**

- [x] 10. 实现简历解析引擎
  - 集成 pdf-parse 库解析 PDF
  - 集成 mammoth 库解析 DOCX
  - 实现文本文件解析
  - 创建 AI 解析服务调用 OpenAI API
  - 实现结构化数据提取（个人信息、教育、经历等）
  - _需求: 2.3, 2.4, 2.5_

- [ ]\* 10.1 编写属性测试：简历解析性能
  - **属性 5: 简历解析性能**
  - **验证: 需求 2.3**

- [ ]\* 10.2 编写属性测试：解析数据结构完整性
  - **属性 6: 解析数据结构完整性**
  - **验证: 需求 2.4**

- [x] 11. 实现简历管理功能
  - 实现获取简历详情（getResume）
  - 实现简历列表查询（listResumes）
  - 实现简历更新（updateResume）
  - 实现简历删除（deleteResume）
  - 实现设置主简历（setPrimaryResume）
  - _需求: 6_

- [ ]\* 11.1 编写属性测试：简历版本唯一性
  - **属性 15: 简历版本唯一性**
  - **验证: 需求 6.1, 6.2**

- [ ]\* 11.2 编写属性测试：历史版本可访问性
  - **属性 16: 历史版本可访问性**
  - **验证: 需求 6.4**

## 职位信息管理

- [x] 12. 实现职位服务
  - 创建 JobService 类
  - 实现创建职位（createJob）
  - 实现职位描述解析（parseJobDescription）
  - 实现从 URL 抓取职位信息（fetchJobFromUrl）
  - _需求: 3.1, 3.2, 3.3_

- [ ]\* 12.1 编写属性测试：职位信息提取
  - **属性 7: 职位信息提取**
  - **验证: 需求 3.3**

- [x] 13. 实现职位管理功能
  - 实现获取职位详情（getJob）
  - 实现职位列表查询（listJobs）
  - 实现职位更新（updateJob）
  - 实现职位删除（deleteJob）
  - _需求: 3.5_

- [ ]\* 13.1 编写职位服务单元测试
  - 测试职位 CRUD 操作
  - 测试 URL 抓取功能
  - _需求: 3_

## AI 优化引擎

- [x] 14. 实现 AI 引擎基础设施
  - 创建 AIEngine 类
  - 配置 OpenAI API 客户端
  - 实现 Prompt 模板管理
  - 实现 AI 调用重试机制
  - 实现响应缓存（Redis）
  - _需求: 12.2_

- [ ]\* 14.1 编写属性测试：AI 调用重试机制
  - **属性 32: AI 调用重试机制**
  - **验证: 需求 12.2**

- [x] 15. 实现匹配度分析
  - 创建 OptimizationService 类
  - 实现匹配度计算（calculateMatchScore）
  - 实现技能匹配分析
  - 实现经验匹配分析
  - 实现教育背景匹配分析
  - 实现关键词覆盖率分析
  - _需求: 4.1, 4.2, 4.3_

- [ ]\* 15.1 编写属性测试：匹配度评分范围
  - **属性 8: 匹配度评分范围**
  - **验证: 需求 4.1**

- [ ]\* 15.2 编写属性测试：匹配度子项完整性
  - **属性 9: 匹配度子项完整性**
  - **验证: 需求 4.2**

- [x] 16. 实现优化建议生成
  - 实现生成优化建议（generateSuggestions）
  - 实现 STAR 法则优化
  - 实现量化成果添加
  - 实现关键词插入建议
  - 实现结构优化建议
  - _需求: 5.1, 5.2, 5.3, 5.4_

- [ ]\* 16.1 编写属性测试：优化建议数量
  - **属性 10: 优化建议数量**
  - **验证: 需求 4.4**

- [ ]\* 16.2 编写属性测试：优化建议格式
  - **属性 11: 优化建议格式**
  - **验证: 需求 5.5**

- [ ]\* 16.3 编写属性测试：STAR 法则应用
  - **属性 12: STAR 法则应用**
  - **验证: 需求 5.2**

- [ ]\* 16.4 编写属性测试：关键词插入建议
  - **属性 13: 关键词插入建议**
  - **验证: 需求 5.4**

- [x] 17. 实现优化建议应用
  - 实现接受建议（applySuggestion）
  - 实现拒绝建议（rejectSuggestion）
  - 实现批量应用建议
  - 实现简历版本创建
  - _需求: 5.6, 5.7, 6.1_

- [ ]\* 17.1 编写属性测试：建议接受后内容更新
  - **属性 14: 建议接受后内容更新**
  - **验证: 需求 5.7**

- [x] 18. 实现优化记录管理
  - 实现创建优化任务（createOptimization）
  - 实现获取优化结果（getOptimization）
  - 实现优化状态管理
  - 实现优化历史查询
  - _需求: 4.5_

- [ ]\* 18.1 编写优化服务单元测试
  - 测试匹配度计算
  - 测试建议生成
  - 测试建议应用
  - _需求: 4, 5_

## PDF 生成服务

- [x] 19. 实现 PDF 生成引擎
  - 创建 GenerateService 类
  - 集成 Puppeteer 库
  - 实现 Handlebars 模板渲染
  - 实现 PDF 生成（generatePDF）
  - 实现 PDF 预览（previewPDF）
  - _需求: 7.1, 7.3_

- [ ]\* 19.1 编写属性测试：PDF 生成性能
  - **属性 17: PDF 生成性能**
  - **验证: 需求 7.1**

- [ ]\* 19.2 编写属性测试：PDF 文件大小限制
  - **属性 18: PDF 文件大小限制**
  - **验证: 需求 7.4**

- [ ]\* 19.3 编写属性测试：ATS 友好格式
  - **属性 19: ATS 友好格式**
  - **验证: 需求 7.5**

- [x] 20. 实现模板系统
  - 创建 3 个基础简历模板（经典、现代、专业）
  - 实现模板配置管理
  - 实现模板列表查询（listTemplates）
  - 实现模板详情获取（getTemplate）
  - 实现自定义选项（字体、颜色、边距）
  - _需求: 7.2, 7.6_

- [x] 21. 实现 PDF 文件管理
  - 实现 PDF 上传到对象存储
  - 实现下载链接生成
  - 实现下载计数
  - 实现文件过期管理
  - _需求: 7.7_

- [ ]\* 21.1 编写 PDF 生成服务单元测试
  - 测试模板渲染
  - 测试 PDF 生成
  - 测试文件存储
  - _需求: 7_

## 面试准备模块

- [x] 22. 实现面试服务
  - 创建 InterviewService 类
  - 实现面试问题生成（generateQuestions）
  - 实现问题类型分类（行为、技术、情景）
  - 实现 STAR 方法答案框架生成
  - 实现回答要点生成
  - _需求: 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ]\* 22.1 编写属性测试：面试问题数量
  - **属性 20: 面试问题数量**
  - **验证: 需求 8.1**

- [ ]\* 22.2 编写属性测试：面试问题类型分布
  - **属性 21: 面试问题类型分布**
  - **验证: 需求 8.2**

- [ ]\* 22.3 编写属性测试：面试问题元数据完整性
  - **属性 22: 面试问题元数据完整性**
  - **验证: 需求 8.3, 8.4, 8.5**

- [x] 23. 实现面试准备导出
  - 实现面试准备清单导出为 PDF（exportInterviewPrep）
  - 实现问题查询（getQuestions）
  - _需求: 8.6_

- [ ]\* 23.1 编写面试服务单元测试
  - 测试问题生成
  - 测试答案建议生成
  - 测试导出功能
  - _需求: 8_

## API 接口实现

- [x] 23.5 实现对话 API
  - POST /api/v1/conversations
  - GET /api/v1/conversations
  - GET /api/v1/conversations/:id
  - PUT /api/v1/conversations/:id
  - DELETE /api/v1/conversations/:id
  - POST /api/v1/conversations/:id/messages
  - GET /api/v1/conversations/:id/messages
  - _需求: 1_

- [x] 24. 实现认证 API
  - POST /api/v1/auth/register
  - POST /api/v1/auth/login
  - POST /api/v1/auth/logout
  - GET /api/v1/auth/me
  - _需求: 2_

- [x] 25. 实现简历 API
  - POST /api/v1/resumes/upload
  - GET /api/v1/resumes/:id/parse
  - GET /api/v1/resumes
  - GET /api/v1/resumes/:id
  - PUT /api/v1/resumes/:id
  - DELETE /api/v1/resumes/:id
  - PUT /api/v1/resumes/:id/primary
  - _需求: 3, 7_

- [x] 26. 实现职位 API
  - POST /api/v1/jobs
  - GET /api/v1/jobs
  - GET /api/v1/jobs/:id
  - PUT /api/v1/jobs/:id
  - DELETE /api/v1/jobs/:id
  - _需求: 4_

- [x] 27. 实现优化 API
  - POST /api/v1/optimizations
  - GET /api/v1/optimizations/:id
  - POST /api/v1/optimizations/:id/suggestions/:suggestionId/accept
  - POST /api/v1/optimizations/:id/suggestions/:suggestionId/reject
  - _需求: 5, 6_

- [x] 28. 实现 PDF 生成 API
  - POST /api/v1/generate/pdf
  - GET /api/v1/templates
  - GET /api/v1/templates/:id
  - _需求: 8_

- [x] 29. 实现面试准备 API
  - POST /api/v1/interview/questions
  - GET /api/v1/interview/questions/:optimizationId
  - GET /api/v1/interview/export/:optimizationId
  - _需求: 9_

- [ ]\* 29.1 编写 API 集成测试
  - 测试所有 API 端点
  - 测试认证和授权
  - 测试错误处理
  - _需求: 所有_

## 安全与性能

- [x] 30. 实现安全措施
  - 配置 HTTPS/TLS
  - 实现 CORS 配置
  - 实现输入验证（class-validator）
  - 实现 SQL 注入防护
  - 实现 XSS 防护
  - 实现文件上传安全检查
  - _需求: 9.1, 9.4_

- [ ]\* 30.1 编写属性测试：HTTPS 传输加密
  - **属性 23: HTTPS 传输加密**
  - **验证: 需求 9.1**

- [ ]\* 30.2 编写属性测试：敏感信息加密存储
  - **属性 24: 敏感信息加密存储**
  - **验证: 需求 9.2**

- [ ]\* 30.3 编写属性测试：文件存储加密
  - **属性 31: 文件存储加密**
  - **验证: 需求 10.3**

- [x] 31. 实现限流和配额管理
  - 实现 API 限流中间件
  - 实现用户配额检查
  - 实现免费用户限制（10 次/小时）
  - 实现专业用户无限制
  - 实现配额显示 API
  - _需求: 12.1, 12.2, 12.3, 12.4, 12.5_

- [ ]\* 31.1 编写属性测试：免费用户限流
  - **属性 35: 免费用户限流**
  - **验证: 需求 12.1**

- [ ]\* 31.2 编写属性测试：配额显示
  - **属性 36: 配额显示**
  - **验证: 需求 12.5**

- [x] 32. 实现性能优化
  - 实现 Redis 缓存（简历解析结果、AI 响应、对话历史）
  - 实现数据库查询优化
  - 实现 API 响应压缩
  - 实现静态资源 CDN 配置
  - _需求: 11_

- [ ]\* 32.1 编写属性测试：API 响应时间
  - **属性 33: API 响应时间**
  - **验证: 需求 11.1**

- [ ]\* 32.2 编写属性测试：优化处理时间
  - **属性 34: 优化处理时间**
  - **验证: 需求 11.3**

- [x] 33. 实现自动清理任务
  - 实现定时任务（Bull Queue）
  - 实现 90 天未访问文件自动删除
  - 实现过期 PDF 清理
  - 实现缓存过期管理
  - _需求: 10.6_

- [ ]\* 33.1 编写属性测试：自动文件清理
  - **属性 32: 自动文件清理**
  - **验证: 需求 10.6**

## 错误处理与日志

- [x] 34. 实现统一错误处理
  - 创建全局异常过滤器
  - 实现标准化错误响应格式
  - 实现错误分类和错误码
  - 实现用户友好错误消息（对话式）
  - _需求: 13.1_

- [ ]\* 34.1 编写属性测试：错误响应标准化
  - **属性 37: 错误响应标准化**
  - **验证: 需求 13.1**

- [x] 35. 实现日志系统
  - 配置 Winston 日志库
  - 实现结构化日志记录（包含会话标识）
  - 实现日志级别管理
  - 实现请求日志中间件
  - 实现错误日志记录
  - _需求: 13.5_

- [ ]\* 35.1 编写属性测试：结构化日志记录
  - **属性 39: 结构化日志记录**
  - **验证: 需求 13.5**

- [x] 36. 实现降级策略
  - 实现 AI 服务降级（基于规则的解析）
  - 实现优化建议降级（预定义建议）
  - 实现面试问题降级（标准问题库）
  - 在对话中返回降级响应
  - _需求: 13.2_

## 前端实现

- [x] 37. 实现用户认证界面
  - 创建现代化登录页面（渐变背景设计）
  - 创建注册页面
  - 实现表单验证
  - 实现认证状态管理（Zustand）
  - 实现受保护路由（ProtectedRoute）
  - 添加社交登录入口（Google、GitHub）
  - _需求: 2_

- [ ]\* 37.1 编写属性测试：用户注册唯一性
  - **属性 7: 用户注册唯一性**
  - **验证: 需求 2.1**

- [ ]\* 37.2 编写属性测试：认证令牌过期
  - **属性 9: 认证令牌过期**
  - **验证: 需求 2.3**

- [x] 38. 实现应用布局（AppLayout）
  - 创建主布局组件
  - 实现左侧边栏（260px 宽度）
  - 实现新对话按钮
  - 实现历史会话列表
  - 实现会话重命名和删除功能
  - 实现用户头像和下拉菜单
  - 实现响应式设计（移动端折叠）
  - _需求: 1_

- [ ]\* 38.1 编写属性测试：会话删除一致性
  - **属性 5: 会话删除一致性**
  - **验证: 需求 1.9**

- [x] 39. 实现对话页面（ChatPage）
  - 使用 Ant Design X 的 Bubble 组件显示对话
  - 使用 Sender 组件实现消息输入
  - 使用 Prompts 组件显示智能提示
  - 实现文件上传功能（PDF、Word）
  - 实现快捷操作按钮（简历优化、面试解忧、自我介绍）
  - 实现加载状态显示
  - 实现 AI/用户头像区分
  - _需求: 1, 3_

- [ ]\* 39.1 编写属性测试：消息显示完整性
  - **属性 1: 消息显示完整性**
  - **验证: 需求 1.2**

- [ ]\* 39.2 编写属性测试：文件上传确认
  - **属性 2: 文件上传确认**
  - **验证: 需求 1.3**

- [ ]\* 39.3 编写属性测试：智能提示显示条件
  - **属性 3: 智能提示显示条件**
  - **验证: 需求 1.5**

- [ ]\* 39.4 编写属性测试：加载状态显示
  - **属性 6: 加载状态显示**
  - **验证: 需求 1.10**

- [x] 40. 实现个人中心页面（ProfilePage）
  - 创建个人信息展示和编辑界面
  - 实现订阅状态显示
  - 实现使用配额显示
  - _需求: 2, 12_

- [ ]\* 40.1 编写属性测试：配额显示
  - **属性 36: 配额显示**
  - **验证: 需求 12.5**

- [x] 41. 实现设置页面（SettingsPage）
  - 创建账户设置界面
  - 实现隐私设置
  - 实现通知设置
  - _需求: 2_

- [x] 42. 实现对话服务集成
  - 创建 conversationStore（Zustand）
  - 实现创建新对话功能
  - 实现加载历史会话功能
  - 实现切换会话功能
  - 实现发送消息功能
  - 实现接收 AI 回复功能
  - _需求: 1_

- [ ]\* 42.1 编写属性测试：会话历史加载
  - **属性 4: 会话历史加载**
  - **验证: 需求 1.7**

- [x] 43. 实现简历上传对话交互
  - 在对话中处理文件上传
  - 显示上传进度和解析状态
  - 在对话中展示解析结果
  - 实现解析结果确认和编辑
  - _需求: 3_

- [ ]\* 43.1 编写属性测试：文件上传格式验证
  - **属性 10: 文件上传格式验证**
  - **验证: 需求 3.1, 3.2**

- [x] 44. 实现职位信息对话交互
  - 在对话中识别职位描述文本
  - 在对话中处理职位链接
  - 在对话中展示提取的职位信息
  - 实现职位信息确认和编辑
  - _需求: 4_

- [x] 45. 实现匹配分析对话交互
  - 在对话中展示匹配度评分
  - 使用进度条和图表可视化匹配度
  - 在对话中展示缺失技能和关键词
  - 在对话中展示改进建议
  - _需求: 5_

- [ ]\* 45.1 编写属性测试：匹配度评分范围
  - **属性 14: 匹配度评分范围**
  - **验证: 需求 5.1**

- [x] 46. 实现优化建议对话交互
  - 在对话中展示优化建议列表
  - 实现建议接受/拒绝按钮
  - 在对话中展示优化前后对比
  - 实现建议应用后的确认反馈
  - _需求: 6_

- [ ]\* 46.1 编写属性测试：优化建议格式
  - **属性 17: 优化建议格式**
  - **验证: 需求 6.5**

- [ ]\* 46.2 编写属性测试：建议接受后内容更新
  - **属性 20: 建议接受后内容更新**
  - **验证: 需求 6.7**

- [x] 47. 实现 PDF 生成对话交互
  - 在对话中展示模板选择卡片
  - 在对话中展示模板预览
  - 在对话中提供自定义选项
  - 在对话中提供下载链接
  - _需求: 8_

- [ ]\* 47.1 编写属性测试：PDF 生成性能
  - **属性 23: PDF 生成性能**
  - **验证: 需求 8.1**

- [x] 48. 实现面试准备对话交互
  - 在对话中展示面试问题列表
  - 实现问题类型标签和难度显示
  - 实现答案建议展开/收起
  - 在对话中提供导出功能
  - _需求: 9_

- [ ]\* 48.1 编写属性测试：面试问题数量
  - **属性 26: 面试问题数量**
  - **验证: 需求 9.1**

- [ ]\* 48.2 编写属性测试：面试问题类型分布
  - **属性 27: 面试问题类型分布**
  - **验证: 需求 9.2**

- [ ]\* 49. 编写前端组件单元测试
  - 测试 ChatPage 组件
  - 测试 AppLayout 组件
  - 测试 LoginPage 组件
  - 测试用户交互
  - 测试状态管理
  - _需求: 所有_

## 部署与监控

- [ ] 44. 配置 Docker 容器化
  - 编写 Dockerfile（frontend + backend）
  - 编写 docker-compose.yml
  - 配置多阶段构建
  - 配置环境变量
  - _需求: 所有_

- [ ] 45. 配置 CI/CD 流程
  - 配置 GitHub Actions
  - 实现自动化测试
  - 实现自动化构建
  - 实现自动化部署
  - _需求: 所有_

- [x] 46. 配置生产环境
  - 配置 PostgreSQL 数据库
  - 配置 Redis 缓存
  - 配置对象存储（S3/OSS）
  - 配置域名和 SSL 证书
  - 配置负载均衡
  - _需求: 10.1, 11.5_

- [x] 47. 实现监控和告警
  - 配置应用性能监控（APM）
  - 配置日志聚合（loki）
  - 配置错误追踪（Sentry）
  - 配置健康检查端点
  - 配置告警规则
  - _需求: 11.5, 13.6_

- [x] 48. 实现数据备份
  - 配置数据库自动备份（包含对话历史）
  - 配置备份验证
  - 配置灾难恢复计划
  - _需求: 10.5_

## 最终检查点

- [x] 49. 端到端测试
  - 编写完整用户流程 E2E 测试
  - 测试注册到 PDF 生成的完整流程
  - 测试错误场景
  - 测试性能指标
  - _需求: 所有_

- [ ] 50. 文档编写
  - 编写 API 文档
  - 编写部署文档
  - 编写用户手册
  - 编写开发者指南
  - _需求: 所有_

- [ ] 51. 最终验收
  - 确保所有测试通过
  - 确保所有需求已实现
  - 确保性能指标达标
  - 确保安全措施到位
  - 准备生产发布
  - _需求: 所有_
